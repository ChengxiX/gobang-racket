#lang racket
(define node (lambda (depth aim situ alphabeta) (
                                                 if (< depth aim) ;(
                                                                   ;if (= (remainder depth 2) 0)
                                                                      ;(maxnode depth aim situ 0 alphabeta -1e20 (let ((dia (area situ))) (next dia (car (car dia)) (car (cdr (car dia))) situ)))
                                                                      ;(minnode depth aim situ 0 alphabeta 1e20 (let ((dia (area situ))) (next dia (car (car dia)) (car (cdr (car dia))) situ)))
                                                                      ;)
                                                    (maxmin (remainder depth 2) depth aim situ 0 alphabeta -1e20 (let ((dia (area situ))) (next dia (car (car dia)) (car (cdr (car dia))) situ)))
                                                    (list (value situ) situ)
                                                    )))
;(define maxnode (lambda (depth aim situ alpha beta able) (
;                                                          let ((x (node (+ depth 1) aim (cons situ (car able)) beta))) (if (and (< (car x) alpha) (not (eq? (cdr able) stopcom)))
;                                                                                                                           (let (y (maxnode depth aim situ alpha (max x beta) (cdr able))) (if (< (car y) (car x)) x y)) x
;                                                                                                                           ))))
;(define minnode (lambda (depth aim situ alpha beta able) (
;                                                          let ((x (node (+ depth 1) aim (cons situ (car able)) beta))) (if (and (> (car x) alpha) (not (eq? (cdr able) stopcom)))
;                                                                                                                           (let (y (maxnode depth aim situ alpha (min x beta) (cdr able))) (if (> (car y) (car x)) x y)) x
;                                                                                                                           ))))

(define maxmin (lambda (re depth aim situ alpha beta able) (
                                                          let ((x (node (+ depth 1) aim (cons situ (car able)) beta)) (fan (if (= re 0)) < >)) (if (and (fan (car x) alpha) (not (eq? (cdr able) stopcom)))
                                                                                                                           (let (y (maxmin re depth aim situ alpha (min x beta) (cdr able))) (if (fan (car y) (car x)) x y)) x
                                                                                                                           ))))
(define stopcom 4.2)

;value函数返回值结构：数字
;(define value (lambda (situ) (
;                              
;                              )))

(define area (lambda (situ)
               (cons (
                      cons (min 14 (+ (apply max (map (lambda (x) (car x)) situ)) 2)) (min 14 (+ (apply max (map (lambda (x) (car (cdr x))) situ))))
                           )
                     (
                      cons (max 0 (- (apply min (map (lambda (x) (car x)) situ)) 2)) (max (- (apply min (map (lambda (x) (car(cdr x))) situ)) 2))
                           ))
               ))

(define next (lambda (diagonol x y situ) (if (<= x (car (cdr diagonol))) (let ([a (if (= y (car (cdr (cdr diagonol)))) (next diagonol (+ 1 x) (car (cdr (car diagonol))) situ) (next diagonol x (+ 1 y) situ))]) (if (member (cons x y) situ) a (cons (cons x y) a))) stopcom)))
